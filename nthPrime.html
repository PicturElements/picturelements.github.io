<!DOCTYPE html>
<html>
  <head>
    <title>n:th prime</title>
    <link rel="icon" href="pelement.png">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,700" rel="stylesheet" type="text/css">
    
    <style>
      body{
        background-image:url("images/stripes.png");
        margin:0;
        font-family: Roboto,Arial,sans-serif;
        font-weight: 700;
      }
      
      #primegen{
        display: block;
        position: fixed;
        width: 100%;
        height: 100%;
        font-size: 3vw;
        color: #069;
        text-align: center;
        line-height: 100vh;
        text-shadow: 0.3vw 0.3vw 0.5vw rgba(0,0,0,0.1);
      }
      
      #primepanel{
        display: none;
        position: fixed;
        width: 60%;
        height: 30vw;
        left: 20%;
        top: 50%;
        margin-top: -15vw;
        background-color: white;
        border-radius: 1vw;
        box-shadow: 0.3vw 0.3vw 1vw rgba(0,0,50,0.3);
        overflow:hidden;
      }
      
      input{
        position: absolute;
        width: 90%;
        left: 5%;
        height: 5vw;
        border: none;
        text-align: center;
        font-size: 4vw;
        font-family: Trebuchet MS;
        top: 4vw;
        border-bottom: 0.2vw solid #999;
        outline: none;
      }
      
      button{
        position: absolute;
        width: 20vw;
        height: 3vw;
        left: 20vw;
        background-color:#ddd;
        font-size: 1.7vw;
        font-family: inherit;
        top: 11.5vw;
        border: none;
        outline: none;
        cursor: pointer;
      }
      
      button:hover{
        background-color:#ccc;
      }
      
      #output{
        position: absolute;
        width: 54vw;
        height: 9vw;
        left: 2vw;
        top: 17vw;
        padding: 1vw;
        background-color: #eee;
        text-align: center;
        font-size: 1.15vw;
      }
    </style>
    <script>
      var primes=[2];
      var primeNo=1,startPos=1,checkNo;
      var thread=null;
    
      function check(){
        checkNo=parseInt(document.getElementById("input").value);
        var isPrime=true;
        if (checkNo>primeNo){
          startPos=primeNo;
          thread=setInterval(loopWrapper,0);
        }else{
          document.getElementById("output").innerHTML="Prime "+checkNo+" is "+primes[checkNo-1];
        }
      }
      
      function loopWrapper(){
        genPrimes();
        startPos+=10000;
        document.getElementById("output").innerHTML="Finished generating "+Math.floor(primeNo/10000)*10000+" primes";
        if (primeNo==checkNo){
          clearInterval(thread);
          document.getElementById("output").innerHTML="Finished generating "+checkNo+" primes<br><br>Prime "+checkNo+" is "+primes[checkNo-1]+".";
          console.log("done!");
        }
      }
      
      function genPrimes(){
        var isPrime;
        for (var i=primes[startPos-1]+1;i>0;i++){
          isPrime=true;
          for (var a=0;primes[a]*primes[a]<=i;a++){
            if (i%primes[a]==0){
              isPrime=false;
              break;
            }
          }
          if (isPrime){
            primes.push(i);
            primeNo++;
            if (primeNo==startPos+10000||primeNo==checkNo){return 0;}   //return meaningless value just to quit function
          }
        }
      }
      
      function setText(){
        var suffix="th";
        var checkNo=parseInt(document.getElementById("input").value);
        if (checkNo>10&&checkNo<20){/*do nothing*/}
        else if (checkNo%10==1){suffix="st";}
        else if(checkNo%10==2){suffix="nd";}
        else if(checkNo%10==3){suffix="rd";}
        document.getElementById("button").innerHTML=""+checkNo+""+suffix+" prime?";
      }
    </script>
  </head>
  <body>
    <div id="primepanel" style="display: block;">
      <input id="input" placeholder="input number" onkeyup="setText()">
      <button id="button" onclick="check()">n:th prime?</button>
      <div id="output">Info will appear will appear here.</div>
    </div>
  </body>
</html>
