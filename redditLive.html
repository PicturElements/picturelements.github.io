<!DOCTYPE html>
<html>
  <head>
    <title>reddit live</title>
    <link rel="icon" href="pelement.png">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
    <script type="text/javascript" src="jQuery.js"></script>
    
    <style>
      body{
        background-color:#bfdcff;
        /*background-image:url("images/updown.png");
        background-size:40px 50px;
        background-position:-20px 0;
        animation:slide 5s linear infinite;*/
        margin:0;
        font-family:Varela Round;
      }
      
      #startupcontainer{
        display:block;
        position
        width:100%;
        height:100%;
        top:0;
        left:0;
      }
      
      #title{
        display: block;
        position: absolute;
        width: 100%;
        font-size: 4vw;
        text-align: center;
        top: 25%;
        margin-top: -3vw;
        color: #555;
      }
      
      #maininput{
        display: block;
        position: absolute;
        width: 40vw;
        height: 2.5vw;
        top: 50%;
        left: 50%;
        margin-top: -1.25vw;
        margin-left: -20vw;
        text-align: center;
        font-size: 1.5vw;
        font-family: Roboto;
        color: #666;
        border: 0.2vw solid #aaa;
        outline: none;
      }
      
      .gobutton_active,.gobutton_inactive{
        display: block;
        position: absolute;
        padding: 1vw;
        width: 7vw;
        text-align: center;
        background-color: #4a9cff;
        border: 0.25vw solid #107cff;
        color: white;
        left: 50%;
        margin-left: -4.75vw;
        top: 50%;
        font-size: 1.5vw;
        margin-top: 4vw;
        cursor: pointer;
      }
      
      .gobutton_active:hover{
        background-color: #107cff;
        border: 0.25vw solid #4a9cff;
      }
      
      .gobutton_inactive{
        background-color: #ccc;
        border: 0.25vw solid #aaa;
        color:#aaa;
        cursor:default;
      }
      
      .gobutton_inactive:hover{
        background-color: #aaa;
        border: 0.25vw solid #ccc;
        color:#ccc;
      }
      
      @keyframes slide{
        to{background-position:-20px -50px;}
      }
    </style>
    <script>
      var clickable=false;
      var glob_id="";
      
      function onloadCheck(){
        if (!window.location.href.endsWith("picturelements.github.io/redditLive")){
          document.getElementById("startupcontainer").style.display="none";
          
          var url=window.location.href,newUrl="";
          for (var i=0;i<6;i++){
            newUrl+=url.charAt(url.length-6+i);
          }
          var url="https://www.reddit.com/comments/"+newUrl+".json";
          $(function(){
      	    $.getJSON(url,function(data){
        			var score=data[0].data.children[0].data;
        		});
        	});
        }
      }
      
      function checkUrlWrapper(element){
        var el=document.getElementById("gobutton");
        clickable=checkUrl(element);
        if (clickable){
          el.className="gobutton_active";
        }else{
          el.className="gobutton_inactive";
        }
      }
      
      function checkUrl(element){
        var url=element.value;
        var checkfor=["comments","redd.it"]
        var checkChar=[0,0];
        for (var i=0;i<url.length;i++){
          for (var n=0;n<2;n++){
            if (url.charAt(i)==checkfor[n].charAt(checkChar[n])){
              checkChar[n]++;
              if (checkChar[n]==checkfor[n].length){
                var id="";
                for (var m=0;m<6;m++){
                  id+=url.charAt(i+2+m);
                }
                console.log(id);
                glob_id=id;
                return true;
              }
            }else{
              checkChar[n]=0;
            }
          }
        }
        return false
      }
      
      function createUrl(){
        if (clickable){window.location.href=(window.location.href+"?id="+glob_id);}
      }
    </script>
  </head>
  <body onload=onloadCheck()>
    <div id="startupcontainer">
      <div id="title">live score counter</div>
      <input id="maininput" onkeyup=checkUrlWrapper(this) placeholder="insert URL">
      <div id="gobutton" class="gobutton_inactive" onclick=createUrl()>Let's go!</div>
    </div>
  </body>
</html>
